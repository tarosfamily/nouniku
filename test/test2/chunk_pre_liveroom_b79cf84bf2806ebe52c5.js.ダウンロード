(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{FRzE:function(e,t,l){"use strict";l("q1tI");t.a=l.p+"assets/svg/f6b109b5a397ad631750a11670dd32a7.svg"},IidK:function(e,t,l){"use strict";l.r(t),l.d(t,"playerFirstProvider",function(){return o});var n=l("SQj2"),r=l("WSuF"),o={done:!1,tryPlayFirst:function(){var e=document.querySelector("#mildom-player-core-wrapper-container");if(!e||!e.parentElement)return void a();n.a.injectPlayer(e.parentElement)&&function(){var e=n.a.startPlay(i);e?(e=n.a.getController())&&(e.playStatus===r.VideoPlayer.PlayerController.PlayerStatus.PLAYING&&(o.done=!0,o.onDone()),e.registerEvent(r.VideoPlayer.PlayerController.PlayerEvent.START,function(){var e,t,l=n.a.getController();l&&(null!=l&&l.hls&&(t=function e(){var t;a(),null!==(t=null==l?void 0:l.hls)&&void 0!==t&&t.off("hlsError",e)},null!==(e=null==l?void 0:l.hls)&&void 0!==e&&e.on("hlsError",t)),l.unregisterEvent(r.VideoPlayer.PlayerController.PlayerEvent.START,s))}),e.registerEvent(r.VideoPlayer.PlayerController.PlayerEvent.SUCCESS,s)):a()}()},onDone:function(){o.done=!0}},i=((window.__INITIAL_STATE__||{}).room_info||{}).user_id;function a(){o.done=!0,o.onDone()}function s(){o.done=!0,o.onDone();var e=n.a.getController();e&&e.unregisterEvent(r.VideoPlayer.PlayerController.PlayerEvent.SUCCESS,s)}i=i||Number(window.location.pathname.substr(1))},K0Hq:function(e,t,l){"use strict";l("q1tI");t.a=l.p+"assets/svg/85544a41ad251a21567e10e638d378ac.svg"},SQj2:function(e,t,l){"use strict";var n=l("lwsE"),r=l.n(n),n=l("W8MJ"),o=l.n(n),i=l("4r7h"),a=l("t/+K"),s=l("IdJ0"),y=l("WSuF"),d=l("SUlE"),c=l("FRzE"),u=l("K0Hq");function p(e,t){var l=0<arguments.length&&void 0!==e&&e,n=1<arguments.length&&void 0!==t?t:30,e=function(){var e=document.createElement("div");e.style.height="100%",e.style.width="100%",e.style.position="absolute",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.overflow="hidden";var t=document.createElement("video");return t.style.height="100%",t.style.width="100%",e.appendChild(t),{playerWrapper:e,videoDom:t}}(),t=e.playerWrapper,e=e.videoDom;e.muted=l,e.volume=n/100;var r=document.createElement("div");r.style.position="absolute",r.style.width="150px",r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.top="50%",r.style.left="50%",r.style.transform="translateX(-50%) translateY(-50%)",r.style.display="none";l=document.createElement("img");l.src=c.a,l.style.width="60px",l.style.marginBottom="7px",r.appendChild(l);n=document.createElement("div");n.style.width="120px",n.style.height="24px",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.pointerEvents="none",r.appendChild(n);var o=document.createElement("div");o.style.position="absolute",o.style.background="rgba(0, 0, 0, 0.5)",o.style.top="0",o.style.left="0",o.style.right="0",o.style.bottom="0",o.style.display="none";l=document.createElement("img");l.style.width="24px",l.style.height="24px",l.style.marginRight="18px",l.src=u.a,n.appendChild(l);l=document.createElement("div");l.style.fontSize="12px",l.style.color="#fff",l.innerText=Object(d.f)("player_loading"),n.appendChild(l),t.appendChild(e),t.appendChild(o),t.appendChild(r);l=new y.VideoPlayer.PlayerController;return l.attachVideo(e),l.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STATUS_CHANGE,function(e){var t=e.status,e=[y.VideoPlayer.PlayerController.PlayerStatus.START];r.style.display=e.includes(t)?"inline-flex":"none",o.style.display=[y.VideoPlayer.PlayerController.PlayerStatus.START,y.VideoPlayer.PlayerController.PlayerStatus.PAUSED].includes(t)?"block":"none"}),l.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STALLED,function(){r.style.display="inline-flex",o.style.display="block"}),l.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STALLED_RECOVER,function(){r.style.display="none",o.style.display="none"}),{wrapperDom:t,videoDom:e,controller:l}}function m(e){var t=(null===(r=(Object(i.c)(a.qb)||{})[e])||void 0===r?void 0:r.definitionList)||[],l=(t=t.sort(function(e,t){return t.pixel-e.pixel})).filter(function(e){return"auto"!==e.cmode&&"audio"!==e.cmode&&"144p"!==e.cmode}).map(function(e){return e.cmode}),n=y.VideoPlayer.getDefaultDefinition(t,{pixel:Object(i.b)(a.zb),cmode:"",name:""}),r=Object(i.c)(a.Yb,[]).filter(function(e){return e.protocol===y.VideoPlayer.SourceProtocol.HLS});if(n&&r&&0<r.length){t=r[0].url,e="".concat(t,"/").concat(e,"_").concat(n.cmode,".m3u8");return{source:e=(e=e.replace("_raw","")).replace("_auto","_master"),definition:n,cmodeWhiteList:l,currentServerLine:r[0]}}return null}l=function(){function e(){r()(this,e),this.playerDom=null,this.video=null,this.container=null,this.controller=null}return o()(e,[{key:"createPlayer",value:function(e){var t=p(!!Object(i.b)(a.Ab,0),Object(i.b)(a.Bb,30)),l=t.wrapperDom,n=t.videoDom,t=t.controller;return this.video=n,this.playerDom=l,this.controller=t,e&&(this.container=e,this.container.appendChild(l)),t.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.SUCCESS,function(){s.b.emit(s.a.LIVE_PLAYER_FIRST_FRAME)}),n}},{key:"injectPlayer",value:function(e){var t=e.querySelector("#mildom-player-core-wrapper-container");if(!t)return!1;var l=function(e){var t=e.querySelector("video");if(t){var l=!!Object(i.b)(a.Ab,0),n=Object(i.b)(a.Bb,30);t.muted=l,t.volume=n/100;var r=document.createElement("div");r.style.position="absolute",r.style.width="150px",r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.top="50%",r.style.left="50%",r.style.transform="translateX(-50%) translateY(-50%)",r.style.display="none";l=document.createElement("img");l.src=c.a,l.style.width="60px",l.style.marginBottom="7px",r.appendChild(l);n=document.createElement("div");n.style.width="120px",n.style.height="24px",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.pointerEvents="none",r.appendChild(n);var o=document.createElement("div");o.style.position="absolute",o.style.background="rgba(0, 0, 0, 0.5)",o.style.top="0",o.style.left="0",o.style.right="0",o.style.bottom="0",o.style.display="none";l=document.createElement("img");l.style.width="24px",l.style.height="24px",l.style.marginRight="18px",l.src=u.a,n.appendChild(l);l=document.createElement("div");l.style.fontSize="12px",l.style.color="#fff",l.innerText=Object(d.f)("player_loading"),n.appendChild(l),e.appendChild(t),e.appendChild(o),e.appendChild(r);e=new y.VideoPlayer.PlayerController;return e.attachVideo(t),e.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STATUS_CHANGE,function(e){var t=e.status,e=[y.VideoPlayer.PlayerController.PlayerStatus.START];r.style.display=e.includes(t)?"inline-flex":"none",o.style.display=[y.VideoPlayer.PlayerController.PlayerStatus.START,y.VideoPlayer.PlayerController.PlayerStatus.PAUSED].includes(t)?"block":"none"}),e.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STALLED,function(){r.style.display="inline-flex",o.style.display="block"}),e.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.STALLED_RECOVER,function(){r.style.display="none",o.style.display="none"}),e}}(t);return!!l&&(this.playerDom=t,this.controller=l,this.video=this.controller.videoDom,this.mountPlayerToContainer(e),l.registerEvent(y.VideoPlayer.PlayerController.PlayerEvent.SUCCESS,function(){s.b.emit(s.a.LIVE_PLAYER_FIRST_FRAME)}),!0)}},{key:"getPlayerElement",value:function(){return this.playerDom}},{key:"getController",value:function(){return this.controller}},{key:"hasPlayerCore",value:function(){return!!this.controller}},{key:"mountPlayerToContainer",value:function(e){e&&this.playerDom&&(this.container=e,this.container.appendChild(this.playerDom),s.b.emit(s.a.LIVE_PLAYER_MOUNT,e),console.log("[live player provider]: mount to container: ",this.container))}},{key:"removePlayer",value:function(){this.container&&this.container.remove(),this.container=null}},{key:"getCurentPlayerContainerId",value:function(){var e;return null===(e=this.container)||void 0===e?void 0:e.id}},{key:"mountToPlayerTmpHolder",value:function(){this.playerCoreTmpHolder||this.createPlayerTmpHolder(),this.mountPlayerToContainer(this.playerCoreTmpHolder)}},{key:"createPlayerTmpHolder",value:function(){var e=document.createElement("div");e.id="mildom-player-core-tmp-holder",e.style.height="0",e.style.width="0",e.style.display="none",document.body.appendChild(e),this.playerCoreTmpHolder=e}},{key:"startPlay",value:function(e){if(!this.video||!this.controller||!e)return!1;var t=m(e);return!!t&&(this.controller.setup({src:t.source,hlsConfig:{liveSyncDurationCount:2,mildomFilterLevels:function(e){return e.length<=1?e:e.filter(function(e){return!t.cmodeWhiteList||t.cmodeWhiteList.length<=0?e:t.cmodeWhiteList.includes(null===(e=e.attrs)||void 0===e?void 0:e.CMODE)})}}}),this.controller.extra.definition=t.definition,this.controller.extra.anchorInfo={anchorId:e},this.controller.init(),!0)}}]),e}(),t.a=new l}}]);
//# sourceMappingURL=http://hw-source-map.mildom.jp/mildompc-web-server-sourcemap/static_sourcemap/pre_liveroom_8a9fe0a6f40176541e90.js.map